<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>RegistrationJFrame.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;The_e-Cheque_Client&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">eCheque</a> &gt; <span class="el_source">RegistrationJFrame.java</span></div><h1>RegistrationJFrame.java</h1><pre class="source lang-java linenums">/*
 * RegistrationFrame.java
 *
 * Created on May 3, 2007, 6:01 PM
 */

package eCheque;

/**
 *
 * @author  Saad
 */
//import com.Trendy.swing.plaf.TrendyLookAndFeel;
//import com.sun.crypto.provider.AESCipher;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.security.spec.KeySpec;
import javax.crypto.Cipher;
import javax.swing.UIManager;
import javax.swing.JOptionPane;
import javax.swing.JFileChooser;
import java.security.*;
import java.io.File;

public class RegistrationJFrame extends javax.swing.JFrame {
    
   private boolean pathFlag;
   private String eWalletPath;
 
   /** Creates new form RegistrationFrame */
<span class="nc" id="L35">   public RegistrationJFrame() {</span>
        try{
            //TrendyLookAndFeel tlf = new TrendyLookAndFeel();
            //tlf.setCurrentTheme( new com.Trendy.swing.plaf.Themes.TrendyOrangeTheme());
            //UIManager.setLookAndFeel(tlf);
        }
        catch(Exception e){
            
            //JOptionPane.showMessageDialog(null,&quot;System Error&quot;, &quot;can not found themes&quot;, JOptionPane.ERROR_MESSAGE);
        
        }
        
<span class="nc" id="L47">        pathFlag = false;</span>
<span class="nc" id="L48">        initComponents();</span>
<span class="nc" id="L49">    }</span>
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot; Generated Code &quot;&gt;//GEN-BEGIN:initComponents
    private void initComponents() {
<span class="nc" id="L58">        jPanel1 = new javax.swing.JPanel();</span>
<span class="nc" id="L59">        jPanel2 = new javax.swing.JPanel();</span>
<span class="nc" id="L60">        jLabel1 = new javax.swing.JLabel();</span>
<span class="nc" id="L61">        jTBankName = new javax.swing.JTextField();</span>
<span class="nc" id="L62">        jLabel2 = new javax.swing.JLabel();</span>
<span class="nc" id="L63">        jTBankURLIP = new javax.swing.JTextField();</span>
<span class="nc" id="L64">        jLabel3 = new javax.swing.JLabel();</span>
<span class="nc" id="L65">        jTClientName = new javax.swing.JTextField();</span>
<span class="nc" id="L66">        jLabel4 = new javax.swing.JLabel();</span>
<span class="nc" id="L67">        jTAccountNo = new javax.swing.JTextField();</span>
<span class="nc" id="L68">        jPanel3 = new javax.swing.JPanel();</span>
<span class="nc" id="L69">        jLabel5 = new javax.swing.JLabel();</span>
<span class="nc" id="L70">        jTIssuerName = new javax.swing.JTextField();</span>
<span class="nc" id="L71">        jLabel6 = new javax.swing.JLabel();</span>
<span class="nc" id="L72">        jTDCURLIP = new javax.swing.JTextField();</span>
<span class="nc" id="L73">        jLabel7 = new javax.swing.JLabel();</span>
<span class="nc" id="L74">        jLabel8 = new javax.swing.JLabel();</span>
<span class="nc" id="L75">        jCValidation = new javax.swing.JComboBox();</span>
<span class="nc" id="L76">        jCSubject = new javax.swing.JComboBox();</span>
<span class="nc" id="L77">        jPanel4 = new javax.swing.JPanel();</span>
<span class="nc" id="L78">        jLabel9 = new javax.swing.JLabel();</span>
<span class="nc" id="L79">        jTUserName = new javax.swing.JTextField();</span>
<span class="nc" id="L80">        jTPassword = new javax.swing.JPasswordField();</span>
<span class="nc" id="L81">        jLabel10 = new javax.swing.JLabel();</span>
<span class="nc" id="L82">        jBeWallet = new javax.swing.JButton();</span>
<span class="nc" id="L83">        jLabel11 = new javax.swing.JLabel();</span>
<span class="nc" id="L84">        jTPassword2 = new javax.swing.JPasswordField();</span>
<span class="nc" id="L85">        jBRFRegister = new javax.swing.JButton();</span>

<span class="nc" id="L87">        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);</span>
<span class="nc" id="L88">        setTitle(&quot;Register&quot;);</span>
<span class="nc" id="L89">        setResizable(false);</span>
<span class="nc" id="L90">        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, &quot;Client Form&quot;, javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font(&quot;Tahoma&quot;, 0, 11), new java.awt.Color(0, 0, 0)));</span>
<span class="nc" id="L91">        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, &quot;Financial Info&quot;, javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font(&quot;Tahoma&quot;, 0, 11), new java.awt.Color(51, 51, 51)));</span>
<span class="nc" id="L92">        jLabel1.setText(&quot;Bank Name&quot;);</span>

<span class="nc" id="L94">        jLabel2.setText(&quot;URL/IP&quot;);</span>

<span class="nc" id="L96">        jLabel3.setText(&quot;Client Name&quot;);</span>

<span class="nc" id="L98">        jLabel4.setText(&quot;Account no.&quot;);</span>

<span class="nc" id="L100">        org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);</span>
<span class="nc" id="L101">        jPanel2.setLayout(jPanel2Layout);</span>
<span class="nc" id="L102">        jPanel2Layout.setHorizontalGroup(</span>
<span class="nc" id="L103">            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L104">            .add(jPanel2Layout.createSequentialGroup()</span>
<span class="nc" id="L105">                .addContainerGap()</span>
<span class="nc" id="L106">                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L107">                    .add(jPanel2Layout.createSequentialGroup()</span>
<span class="nc" id="L108">                        .add(jLabel1)</span>
<span class="nc" id="L109">                        .add(8, 8, 8)</span>
<span class="nc" id="L110">                        .add(jTBankName, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 122, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L111">                    .add(jPanel2Layout.createSequentialGroup()</span>
<span class="nc" id="L112">                        .add(jLabel3)</span>
<span class="nc" id="L113">                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L114">                        .add(jTClientName, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 122, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))</span>
<span class="nc" id="L115">                .add(16, 16, 16)</span>
<span class="nc" id="L116">                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)</span>
<span class="nc" id="L117">                    .add(jPanel2Layout.createSequentialGroup()</span>
<span class="nc" id="L118">                        .add(jLabel2)</span>
<span class="nc" id="L119">                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L120">                        .add(jTBankURLIP, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 128, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L121">                    .add(jPanel2Layout.createSequentialGroup()</span>
<span class="nc" id="L122">                        .add(jLabel4)</span>
<span class="nc" id="L123">                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L124">                        .add(jTAccountNo)))</span>
<span class="nc" id="L125">                .addContainerGap(14, Short.MAX_VALUE))</span>
        );
<span class="nc" id="L127">        jPanel2Layout.setVerticalGroup(</span>
<span class="nc" id="L128">            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L129">            .add(jPanel2Layout.createSequentialGroup()</span>
<span class="nc" id="L130">                .addContainerGap()</span>
<span class="nc" id="L131">                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)</span>
<span class="nc" id="L132">                    .add(jTBankName, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L133">                    .add(jLabel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L134">                    .add(jLabel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L135">                    .add(jTBankURLIP, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L136">                .add(14, 14, 14)</span>
<span class="nc" id="L137">                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)</span>
<span class="nc" id="L138">                    .add(jLabel3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L139">                    .add(jLabel4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L140">                    .add(jTAccountNo, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L141">                    .add(jTClientName, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L142">                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))</span>
        );

<span class="nc" id="L145">        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(null, &quot;Digital Certificate Info&quot;, javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font(&quot;Tahoma&quot;, 0, 11), new java.awt.Color(0, 0, 0)));</span>
<span class="nc" id="L146">        jLabel5.setText(&quot;Issuer&quot;);</span>

<span class="nc" id="L148">        jLabel6.setText(&quot;URL/IP&quot;);</span>

<span class="nc" id="L150">        jLabel7.setText(&quot;Subject&quot;);</span>

<span class="nc" id="L152">        jLabel8.setText(&quot;Validation&quot;);</span>

<span class="nc" id="L154">        jCValidation.setModel(new javax.swing.DefaultComboBoxModel(new String[] { &quot;3 months&quot;, &quot;6 months&quot;, &quot;9 months&quot;, &quot;12 months&quot; }));</span>

<span class="nc" id="L156">        jCSubject.setModel(new javax.swing.DefaultComboBoxModel(new String[] { &quot;e-cheque services&quot;, &quot;e-stocks&quot;, &quot;other e-banking&quot; }));</span>

<span class="nc" id="L158">        org.jdesktop.layout.GroupLayout jPanel3Layout = new org.jdesktop.layout.GroupLayout(jPanel3);</span>
<span class="nc" id="L159">        jPanel3.setLayout(jPanel3Layout);</span>
<span class="nc" id="L160">        jPanel3Layout.setHorizontalGroup(</span>
<span class="nc" id="L161">            jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L162">            .add(jPanel3Layout.createSequentialGroup()</span>
<span class="nc" id="L163">                .addContainerGap()</span>
<span class="nc" id="L164">                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L165">                    .add(jLabel5)</span>
<span class="nc" id="L166">                    .add(jLabel7))</span>
<span class="nc" id="L167">                .add(24, 24, 24)</span>
<span class="nc" id="L168">                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)</span>
<span class="nc" id="L169">                    .add(jCSubject, 0, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="nc" id="L170">                    .add(jTIssuerName, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 122, Short.MAX_VALUE))</span>
<span class="nc" id="L171">                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L172">                    .add(jPanel3Layout.createSequentialGroup()</span>
<span class="nc" id="L173">                        .add(25, 25, 25)</span>
<span class="nc" id="L174">                        .add(jLabel6))</span>
<span class="nc" id="L175">                    .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel3Layout.createSequentialGroup()</span>
<span class="nc" id="L176">                        .add(12, 12, 12)</span>
<span class="nc" id="L177">                        .add(jLabel8)))</span>
<span class="nc" id="L178">                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L179">                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)</span>
<span class="nc" id="L180">                    .add(jCValidation, 0, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="nc" id="L181">                    .add(jTDCURLIP, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 119, Short.MAX_VALUE))</span>
<span class="nc" id="L182">                .addContainerGap(15, Short.MAX_VALUE))</span>
        );
<span class="nc" id="L184">        jPanel3Layout.setVerticalGroup(</span>
<span class="nc" id="L185">            jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L186">            .add(jPanel3Layout.createSequentialGroup()</span>
<span class="nc" id="L187">                .addContainerGap()</span>
<span class="nc" id="L188">                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)</span>
<span class="nc" id="L189">                    .add(jLabel5, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L190">                    .add(jTIssuerName, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L191">                    .add(jLabel6, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L192">                    .add(jTDCURLIP, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L193">                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L194">                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)</span>
<span class="nc" id="L195">                    .add(jLabel7)</span>
<span class="nc" id="L196">                    .add(jLabel8)</span>
<span class="nc" id="L197">                    .add(jCValidation, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L198">                    .add(jCSubject, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L199">                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))</span>
        );

<span class="nc" id="L202">        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(null, &quot;Security Sittings&quot;, javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font(&quot;Tahoma&quot;, 0, 11), new java.awt.Color(0, 0, 0)));</span>
<span class="nc" id="L203">        jLabel9.setText(&quot;User name&quot;);</span>

<span class="nc" id="L205">        jLabel10.setText(&quot;Password&quot;);</span>

<span class="nc" id="L207">        jBeWallet.setText(&quot;Create E-Wallet&quot;);</span>
<span class="nc" id="L208">        jBeWallet.addMouseListener(new java.awt.event.MouseAdapter() {</span>
            public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L210">                jBeWalletMouseClicked(evt);</span>
<span class="nc" id="L211">            }</span>
        });

<span class="nc" id="L214">        jLabel11.setText(&quot;re-Password&quot;);</span>

<span class="nc" id="L216">        org.jdesktop.layout.GroupLayout jPanel4Layout = new org.jdesktop.layout.GroupLayout(jPanel4);</span>
<span class="nc" id="L217">        jPanel4.setLayout(jPanel4Layout);</span>
<span class="nc" id="L218">        jPanel4Layout.setHorizontalGroup(</span>
<span class="nc" id="L219">            jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L220">            .add(jPanel4Layout.createSequentialGroup()</span>
<span class="nc" id="L221">                .addContainerGap()</span>
<span class="nc" id="L222">                .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L223">                    .add(jLabel9)</span>
<span class="nc" id="L224">                    .add(jLabel10)</span>
<span class="nc" id="L225">                    .add(jLabel11))</span>
<span class="nc" id="L226">                .add(14, 14, 14)</span>
<span class="nc" id="L227">                .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)</span>
<span class="nc" id="L228">                    .add(jTPassword2)</span>
<span class="nc" id="L229">                    .add(jTPassword)</span>
<span class="nc" id="L230">                    .add(jTUserName, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 125, Short.MAX_VALUE))</span>
<span class="nc" id="L231">                .add(57, 57, 57)</span>
<span class="nc" id="L232">                .add(jBeWallet)</span>
<span class="nc" id="L233">                .add(22, 22, 22))</span>
        );
<span class="nc" id="L235">        jPanel4Layout.setVerticalGroup(</span>
<span class="nc" id="L236">            jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L237">            .add(jPanel4Layout.createSequentialGroup()</span>
<span class="nc" id="L238">                .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L239">                    .add(jPanel4Layout.createSequentialGroup()</span>
<span class="nc" id="L240">                        .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)</span>
<span class="nc" id="L241">                            .add(jLabel9)</span>
<span class="nc" id="L242">                            .add(jTUserName, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L243">                        .add(9, 9, 9)</span>
<span class="nc" id="L244">                        .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)</span>
<span class="nc" id="L245">                            .add(jLabel10)</span>
<span class="nc" id="L246">                            .add(jTPassword, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
<span class="nc" id="L247">                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L248">                        .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)</span>
<span class="nc" id="L249">                            .add(jTPassword2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L250">                            .add(jLabel11)))</span>
<span class="nc" id="L251">                    .add(jPanel4Layout.createSequentialGroup()</span>
<span class="nc" id="L252">                        .addContainerGap()</span>
<span class="nc" id="L253">                        .add(jBeWallet, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 69, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))</span>
<span class="nc" id="L254">                .addContainerGap(21, Short.MAX_VALUE))</span>
        );

<span class="nc" id="L257">        jBRFRegister.setText(&quot;Register&quot;);</span>
<span class="nc" id="L258">        jBRFRegister.addMouseListener(new java.awt.event.MouseAdapter() {</span>
            public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L260">                jBRFRegisterMouseClicked(evt);</span>
<span class="nc" id="L261">            }</span>
        });

<span class="nc" id="L264">        org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);</span>
<span class="nc" id="L265">        jPanel1.setLayout(jPanel1Layout);</span>
<span class="nc" id="L266">        jPanel1Layout.setHorizontalGroup(</span>
<span class="nc" id="L267">            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L268">            .add(jPanel1Layout.createSequentialGroup()</span>
<span class="nc" id="L269">                .addContainerGap()</span>
<span class="nc" id="L270">                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)</span>
<span class="nc" id="L271">                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="nc" id="L272">                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="nc" id="L273">                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 404, Short.MAX_VALUE)))</span>
<span class="nc" id="L274">            .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel1Layout.createSequentialGroup()</span>
<span class="nc" id="L275">                .addContainerGap(153, Short.MAX_VALUE)</span>
<span class="nc" id="L276">                .add(jBRFRegister, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 105, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L277">                .add(156, 156, 156))</span>
        );
<span class="nc" id="L279">        jPanel1Layout.setVerticalGroup(</span>
<span class="nc" id="L280">            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L281">            .add(jPanel1Layout.createSequentialGroup()</span>
<span class="nc" id="L282">                .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L283">                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L284">                .add(jPanel3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L285">                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L286">                .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="nc" id="L287">                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)</span>
<span class="nc" id="L288">                .add(jBRFRegister, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 34, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))</span>
        );

<span class="nc" id="L291">        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());</span>
<span class="nc" id="L292">        getContentPane().setLayout(layout);</span>
<span class="nc" id="L293">        layout.setHorizontalGroup(</span>
<span class="nc" id="L294">            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L295">            .add(layout.createSequentialGroup()</span>
<span class="nc" id="L296">                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L297">                .addContainerGap(20, Short.MAX_VALUE))</span>
        );
<span class="nc" id="L299">        layout.setVerticalGroup(</span>
<span class="nc" id="L300">            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)</span>
<span class="nc" id="L301">            .add(layout.createSequentialGroup()</span>
<span class="nc" id="L302">                .addContainerGap()</span>
<span class="nc" id="L303">                .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)</span>
<span class="nc" id="L304">                .addContainerGap())</span>
        );
<span class="nc" id="L306">        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();</span>
<span class="nc" id="L307">        setBounds((screenSize.width-458)/2, (screenSize.height-482)/2, 458, 482);</span>
<span class="nc" id="L308">    }// &lt;/editor-fold&gt;//GEN-END:initComponents</span>
    
    private String getWalletLoaction(String dialogTitle){
    
<span class="nc" id="L312">        JFileChooser fileChooser = new JFileChooser();</span>
<span class="nc" id="L313">        fileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);      </span>
        
<span class="nc" id="L315">        fileChooser.setDialogTitle(dialogTitle);</span>
    
<span class="nc" id="L317">        int result = fileChooser.showOpenDialog( this );</span>
 
<span class="nc bnc" id="L319" title="All 2 branches missed.">        if ( result == JFileChooser.CANCEL_OPTION )</span>
<span class="nc" id="L320">             return &quot;&quot;;</span>
 
<span class="nc" id="L322">        File fileName = fileChooser.getSelectedFile();</span>
 
         // display error if invalid
<span class="nc bnc" id="L325" title="All 4 branches missed.">         if ( ( fileName == null ) || ( fileName.getName().equals( &quot;&quot; ) ) )</span>
         {
<span class="nc" id="L327">            JOptionPane.showMessageDialog( this, &quot;Invalid File Name&quot;,</span>
              &quot;Invalid File Name&quot;, JOptionPane.ERROR_MESSAGE );
<span class="nc" id="L329">           return &quot;&quot;;</span>
         } // end if
        
<span class="nc" id="L332">        return fileName.getPath();</span>
        
    }
    private void jBeWalletMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jBeWalletMouseClicked
// TODO add your handling code here:
        
<span class="nc" id="L338">        eWalletPath = getWalletLoaction(&quot;Set e-Wallet Location&quot;);</span>
        File wallet;
<span class="nc" id="L340">        wallet= new File(eWalletPath+&quot;\\In Coming&quot;);</span>
<span class="nc" id="L341">        wallet.mkdirs();</span>
<span class="nc" id="L342">        wallet= new File(eWalletPath+&quot;\\Out going&quot;);</span>
<span class="nc" id="L343">        wallet.mkdirs();</span>
<span class="nc" id="L344">        wallet = new File(eWalletPath+&quot;\\Security Tools &quot;);</span>
<span class="nc" id="L345">        wallet.mkdirs();</span>
<span class="nc" id="L346">        wallet = new File(eWalletPath+&quot;\\My Cheques &quot;);</span>
<span class="nc" id="L347">        wallet.mkdirs();</span>
<span class="nc" id="L348">        wallet = new File(eWalletPath+&quot;\\History &quot;);</span>
<span class="nc" id="L349">        wallet.mkdirs();</span>
        
<span class="nc" id="L351">        pathFlag = true;        </span>
<span class="nc" id="L352">    }//GEN-LAST:event_jBeWalletMouseClicked</span>
    private void jBRFRegisterMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jBRFRegisterMouseClicked
// TODO add your handling code here:
        
        String bankName;
        String bankURL;
        String clientName;
        String accountNumber;
        String digitalCIssuer;
        String digitalCURL;
        String userName;
        char [] password;
        char []password2;
        int userNameCode;
        int passwordCode;
        
        
<span class="nc" id="L369">        bankName = jTBankName.getText();</span>
<span class="nc" id="L370">        bankURL = jTBankURLIP.getText();</span>
<span class="nc" id="L371">        clientName = jTClientName.getText();</span>
<span class="nc" id="L372">        accountNumber = jTAccountNo.getText();</span>
<span class="nc" id="L373">        digitalCIssuer = jTIssuerName.getText();</span>
<span class="nc" id="L374">        digitalCURL = jTDCURLIP.getText();</span>
<span class="nc" id="L375">        userName = jTUserName.getText();</span>
<span class="nc" id="L376">        password =  jTPassword.getPassword();</span>
<span class="nc" id="L377">        password2 = jTPassword2.getPassword();</span>
        
<span class="nc bnc" id="L379" title="All 2 branches missed.">        if(bankName.length()!=0){</span>
            
<span class="nc bnc" id="L381" title="All 2 branches missed.">                if(bankURL.length()!=0){</span>
                    
<span class="nc bnc" id="L383" title="All 2 branches missed.">                    if(clientName.length()!=0){</span>
                        
<span class="nc bnc" id="L385" title="All 2 branches missed.">                            if(accountNumber.length()!=0){</span>
                                
<span class="nc bnc" id="L387" title="All 2 branches missed.">                                if(digitalCIssuer.length()!=0){</span>
                                    
<span class="nc bnc" id="L389" title="All 2 branches missed.">                                    if(digitalCURL.length()!=0){</span>
                                        
<span class="nc bnc" id="L391" title="All 2 branches missed.">                                            if(userName.length()!=0){</span>
<span class="nc" id="L392">                                                  String passTemp=&quot;&quot;;</span>
<span class="nc" id="L393">                                                  String passTemp2=&quot;&quot;;</span>
                                                        
<span class="nc bnc" id="L395" title="All 2 branches missed.">                                                  for(int i=0; i&lt;password.length; i++){</span>
<span class="nc" id="L396">                                                       passTemp+=password[i];</span>
<span class="nc" id="L397">                                                       passTemp2+=password2[i];</span>
                                                  }
<span class="nc bnc" id="L399" title="All 2 branches missed.">                                                if(passTemp.compareTo(passTemp2)==0){</span>
                                                      
                                                
<span class="nc bnc" id="L402" title="All 4 branches missed.">                                                if(password.length &gt;= 8 &amp;&amp; password.length &lt;16)</span>
                                                {
<span class="nc bnc" id="L404" title="All 2 branches missed.">                                                    if(pathFlag){</span>
                                                        
                                                        // prepare the user name and password.
<span class="nc" id="L407">                                                        userNameCode = userName.hashCode();</span>
                                                        
                                                        
                                                        
<span class="nc bnc" id="L411" title="All 2 branches missed.">                                                        if(password.length&lt;16){</span>
<span class="nc" id="L412">                                                          int pad = 16 - password.length;</span>
                                                          
<span class="nc bnc" id="L414" title="All 2 branches missed.">                                                          for(int i=0; i&lt;pad; i++){</span>
<span class="nc" id="L415">                                                            passTemp+=password[i];</span>
                                                          }  
                                                        }
<span class="nc" id="L418">                                                        passwordCode = passTemp.hashCode();</span>
                                                        
                                                        //For Test: JOptionPane.showMessageDialog(null,passTemp);
                                                        
                                                        //create a registeration object to save user registeration data
<span class="nc" id="L423">                                                        EChequeRegisteration registerationObj = new EChequeRegisteration();</span>
<span class="nc" id="L424">                                                        registerationObj.setBankName(bankName);</span>
<span class="nc" id="L425">                                                        registerationObj.setBankAddress(bankURL);</span>
<span class="nc" id="L426">                                                        registerationObj.setClientName(clientName);</span>
<span class="nc" id="L427">                                                        registerationObj.setAccountNumber(accountNumber);</span>
<span class="nc" id="L428">                                                        registerationObj.setEWalletLoaction(eWalletPath);</span>
<span class="nc" id="L429">                                                        registerationObj.setUsername(userNameCode);</span>
<span class="nc" id="L430">                                                        registerationObj.setPasword(passwordCode);</span>
                                                        
                                                        
                                                        try {
                                                            ObjectOutputStream outObj; 
                                                            // create the user digital certificate (digital identity)
<span class="nc" id="L436">                                                            RSAGenerator keyGen = new RSAGenerator();</span>
<span class="nc" id="L437">                                                            KeyPair RSAKeys = keyGen.GenerateRSAKeys();</span>
                                                            
                                                            // encrypt private key with user password. 
<span class="nc" id="L440">                                                            outObj = new ObjectOutputStream(new FileOutputStream(eWalletPath+&quot;\\Security Tools\\privateKey.key&quot;));</span>
<span class="nc" id="L441">                                                            outObj.writeObject(RSAKeys.getPrivate());</span>
<span class="nc" id="L442">                                                            outObj.close();</span>
                                                            
                                                            //create AES Key with user password and cipher  
<span class="nc" id="L445">                                                            AESCrypt aesCrypt = new AESCrypt();</span>
<span class="nc" id="L446">                                                            Key AES128 = aesCrypt.inilizeAESKeyByPassword(passTemp);</span>
<span class="nc" id="L447">                                                            Cipher cipher = aesCrypt.initializeCipher(AES128,0);</span>
<span class="nc" id="L448">                                                            InputStream in = new FileInputStream(eWalletPath+&quot;\\Security Tools\\privateKey.key&quot;);</span>
<span class="nc" id="L449">                                                            OutputStream out = new FileOutputStream(eWalletPath+&quot;\\Security Tools\\Private Key.key&quot;); </span>
                                                            
                                                            // encrypt the private key with the AES key and delete the plain key
<span class="nc" id="L452">                                                            aesCrypt.crypt(in,out,cipher);</span>
<span class="nc" id="L453">                                                            in.close();</span>
<span class="nc" id="L454">                                                            out.close();</span>
<span class="nc" id="L455">                                                            File control = new File(eWalletPath+&quot;\\Security Tools\\privateKey.key&quot;);</span>
<span class="nc" id="L456">                                                            control.delete();</span>
                                                            
                                                            // create Digital certificate object.
<span class="nc" id="L459">                                                            DigitalCertificate dcObj = new DigitalCertificate();</span>
<span class="nc" id="L460">                                                            dcObj.setHolderName(clientName);</span>
<span class="nc" id="L461">                                                            dcObj.setIssuer(digitalCIssuer);</span>
<span class="nc" id="L462">                                                            dcObj.setSubject(jCSubject.getSelectedItem().toString());</span>
<span class="nc" id="L463">                                                            dcObj.setValidFrom(jCValidation.getSelectedItem().toString());</span>
<span class="nc" id="L464">                                                            dcObj.setValidTo(jCValidation.getSelectedItem().toString());</span>
<span class="nc" id="L465">                                                            dcObj.setPublicKey(RSAKeys.getPublic());</span>
                                                            
                                                            // save the user digital certificate
<span class="nc" id="L468">                                                            DigitalCertificateIO dcIO = new DigitalCertificateIO();</span>
<span class="nc" id="L469">                                                            dcIO.SaveDC(dcObj,eWalletPath+&quot;\\Security Tools\\&quot;+registerationObj.getClientName()+&quot;DigCert.edc&quot;);</span>
                                                            
                                                                                                                
                                                            //Connect to the bank server to activate the e-cheque account.
<span class="nc" id="L473">                                                            Runnable client = new EchequeClient(8189,0,registerationObj.getBankAddress(),registerationObj,</span>
                                                                    dcObj);
<span class="nc" id="L475">                                                            Thread t = new Thread(client);</span>
<span class="nc" id="L476">                                                            t.start();</span>
                                                            //JOptionPane.showMessageDialog(null,&quot;Registeration Done\n\tYou have to restart your system&quot;,&quot;Confirm&quot;,
                                                                    //JOptionPane.INFORMATION_MESSAGE);
                                                        }
<span class="nc" id="L480">                                                        catch(IOException exp){</span>
<span class="nc" id="L481">                                                            JOptionPane.showMessageDialog(null,&quot;Access Disk Media is not allowed&quot;, &quot;System Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
                                                        }
<span class="nc" id="L483">                                                        catch (NoSuchAlgorithmException exp){</span>
<span class="nc" id="L484">                                                            JOptionPane.showMessageDialog(null,&quot;ONE of your Java Securiy Feature not available&quot;, &quot;Platform Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
                                                        }
<span class="nc" id="L486">                                                        catch (Exception exp){</span>
<span class="nc" id="L487">                                                            JOptionPane.showMessageDialog(null,exp.getMessage(), &quot;Error Message&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L488">                                                        }</span>
                                                        
<span class="nc" id="L490">                                                    }</span>
                                                    else {
<span class="nc" id="L492">                                                        JOptionPane.showMessageDialog(null,&quot;You have to create your e-wallet&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
                                                            
                                                    }
                                                }
                                                else{
<span class="nc" id="L497">                                                    JOptionPane.showMessageDialog(null,&quot;Your password should be between 8 - 15 characters&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
                                                }
                                            
                                                }
                                                else{
<span class="nc" id="L502">                                                    JOptionPane.showMessageDialog(null,&quot;Passwords not match &quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);  </span>
                                                }
<span class="nc" id="L504">                                            }</span>
                                            else{
<span class="nc" id="L506">                                                JOptionPane.showMessageDialog(null,&quot;User name can not be empty&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
                                            }
                                    }
                                    else{
<span class="nc" id="L510">                                        JOptionPane.showMessageDialog(null,&quot;Certificate issuer URl or IP can not be empty&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
                                    }
                                } 
                                else{
<span class="nc" id="L514">                                    JOptionPane.showMessageDialog(null,&quot;Certificate issuer can not be empty&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
                               }
                            }
                            else{
<span class="nc" id="L518">                                JOptionPane.showMessageDialog(null,&quot;Account number can not be empty&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
       
                            }
                    }
                    else
                    {
<span class="nc" id="L524">                        JOptionPane.showMessageDialog(null,&quot;Client name can not be empty&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
       
                    }
                }
                else{
<span class="nc" id="L529">                    JOptionPane.showMessageDialog(null,&quot;Bank URL or IP address can not be empty&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
                }
        }
        else{
<span class="nc" id="L533">            JOptionPane.showMessageDialog(null,&quot;Bank Name can not be empty&quot;, &quot;User Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
        }
        
<span class="nc" id="L536">    }//GEN-LAST:event_jBRFRegisterMouseClicked</span>
    
    /**
     * @param args the command line arguments
     */
       
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jBRFRegister;
    private javax.swing.JButton jBeWallet;
    private javax.swing.JComboBox jCSubject;
    private javax.swing.JComboBox jCValidation;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JTextField jTAccountNo;
    private javax.swing.JTextField jTBankName;
    private javax.swing.JTextField jTBankURLIP;
    private javax.swing.JTextField jTClientName;
    private javax.swing.JTextField jTDCURLIP;
    private javax.swing.JTextField jTIssuerName;
    private javax.swing.JPasswordField jTPassword;
    private javax.swing.JPasswordField jTPassword2;
    private javax.swing.JTextField jTUserName;
    // End of variables declaration//GEN-END:variables
    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>